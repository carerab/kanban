<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>在庫リンク</title>
<style>
body{font-family:system-ui, sans-serif;background:#f7f7f7;margin:0;padding:24px;}
h1{font-size:22px;margin-bottom:10px;}
a.btn{display:block;margin:8px 0;padding:14px;border-radius:8px;text-align:center;text-decoration:none;color:#fff;font-weight:bold;}
.btn.amz{background:#ff9900;}
.btn.rkt{background:#bf0000;}
.btn.yah{background:#6400ff;}
.btn.fav{background:#333;}
input,button{padding:10px;font-size:16px;border:1px solid #ccc;border-radius:6px;}
</style>
</head>
<body>
<h1 id="title">商品リンク</h1>
<p id="desc"></p>
<a id="amazon" class="btn amz" target="_blank">Amazonで検索</a>
<a id="rakuten" class="btn rkt" target="_blank">楽天で検索</a>
<a id="yahoo" class="btn yah" target="_blank">Yahoo!で検索</a>

<hr>
<p><strong>お気に入り商品URLを登録（この端末に保存）</strong></p>
<input id="favUrl" type="url" placeholder="https://www.amazon.co.jp/dp/...">
<button id="saveFav">保存</button>
<br><br>
<a id="favBtn" class="btn fav" target="_blank" style="display:none;">★ お気に入りで開く</a>

<script>
const q = new URLSearchParams(location.search).get("q") || "未設定";
document.getElementById("title").textContent = `${q} の購入リンク`;
document.getElementById("desc").textContent = `品目: ${q}`;
const enc = encodeURIComponent(q);
document.getElementById("amazon").href = `https://www.amazon.co.jp/s?k=${enc}`;
document.getElementById("rakuten").href = `https://search.rakuten.co.jp/search/mall/${enc}/`;
document.getElementById("yahoo").href = `https://shopping.yahoo.co.jp/search?p=${enc}`;

const key=`fav:${q}`;
const fav=localStorage.getItem(key);
const favBtn=document.getElementById("favBtn");
const favInput=document.getElementById("favUrl");
function updateFav(){
  const u=localStorage.getItem(key);
  if(u){favBtn.style.display='block';favBtn.href=u;favInput.value=u;}
}
document.getElementById("saveFav").onclick=()=>{
  const u=favInput.value.trim();
  if(!u){alert("URLを入力してください");return;}
  localStorage.setItem(key,u);
  updateFav();
  alert("お気に入りを保存しました。");
};
updateFav();
</script>
</body>
</html>
